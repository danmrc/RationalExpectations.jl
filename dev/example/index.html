<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example · RationalExpectations</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>RationalExpectations</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../sims/">Sims</a></li><li><a class="toctext" href="../klein/">Klein</a></li><li class="current"><a class="toctext" href>Example</a><ul class="internal"></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Example</a></li></ul><a class="edit-page" href="https://github.com/danmrc/RationalExpectations.jl/blob/master/docs/src/example.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Example</span><a class="fa fa-bars" href="#"></a></div></header><p>We will implement the model from Galí(2008), chapter 3. We will need to write two separated models, as the sintax for the Sims solver is different of the sintaxe of the Klein solver. First, let`s use the same calibration as Galí(2008):</p><div><pre><code class="language-julia">sigma = 1
phi_pi = 1.5
phi_y = 0.5/4
beta = 0.99
phi = 1
alph = 1/3
ep = 6
theta = 2/3
rho_v = 0.5

Theta = (1-alph)/(1-alph+alph*ep)
lambda = (1-theta)*((1-beta*theta)/theta)*Theta
kappa = lambda*(sigma+(phi+alph)/(1-alph))</code></pre><pre><code class="language-none">0.12750000000000006</code></pre></div><p>The equations are:</p><div>\[\pi_t = \beta E_t(\pi_{t+1}) + \kappa\tilde{y}_t\\
\tilde{y}_t = -\frac{1}{\sigma}(i_t - E_t(\pi_{t+1})) + E_t(\tilde{y}_{t+1})\\
i_t = \rho + \phi_{\pi}\pi_t + \phi_{\tilde{y}_t}\tilde{y}_t + v_t\\
v_t = \rho_v v_{t-1} + \varepsilon_v\\\]</div><p>We ignore the <span>$r^n_t$</span> term as Galí(2008) does. We will write this in a way that is consistent with the Klein method (equation 1), so the matrices are</p><div>\[A = \begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0\\
-1 &amp; 1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; \beta &amp; 0\\
0 &amp; -1 &amp; 1 &amp; \sigma\\
\end{pmatrix},

B = \begin{pmatrix}
\rho_v &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; \phi_\pi &amp; \phi_y\\
0 &amp; 0 &amp; 1 &amp; -\kappa\\
0 &amp; 0 &amp; 0 &amp; \sigma\\
\end{pmatrix},

C = \begin{pmatrix}
1\\
0\\
0\\
0\\\end{pmatrix}\]</div><p>As in Gali(2008), we will set a initial monetary poliocy shock of 0.25. This works as an initial condition for the model. As usual, we set that the expected value of the shocks are zero. We will receive the impulse response function automatically.</p><div><pre><code class="language-julia">using  Plots, RationalExpectations

A = [[1 0 0 0];[-1 1 0 0]; [0 0 beta 0]; [0 -1 1 sigma]]
B = [[rho_v 0 0 0];[0 0 phi_pi phi_y];[0 0 1 -kappa];[0 0 0 sigma]]

C = [1;0; 0; 0]

k0 = [0.25;0]

t=12

choque = [0.; 0;0; 0]

klein_sol = klein(A,B,C,t,k0,choque,[3 4])</code></pre><pre><code class="language-none">[ Info: Blanchard Khan conditions satisfied!
12×4 Array{Float64,2}:
 0.25         0.0          -0.0359661    -0.142454
 0.125        0.053244     -0.0179831    -0.0712271
 0.0625       0.026622     -0.00899154   -0.0356135
 0.03125      0.013311     -0.00449577   -0.0178068
 0.015625     0.0066555    -0.00224788   -0.00890339
 0.0078125    0.00332775   -0.00112394   -0.00445169
 0.00390625   0.00166388   -0.000561971  -0.00222585
 0.00195313   0.000831938  -0.000280986  -0.00111292
 0.000976563  0.000415969  -0.000140493  -0.000556462
 0.000488281  0.000207984  -7.02464e-5   -0.000278231
 0.000244141  0.000103992  -3.51232e-5   -0.000139115
 0.00012207   5.19961e-5   -1.75616e-5   -6.95577e-5</code></pre></div><p>We can plot the elements of <code>klein_sol</code> to see the irf</p><p>Sims methods requires that we write expectations error, e.g. <span>$\eta_t^{\pi} = \pi_t - E_{t-1}(\pi_t)$</span>. We can work it to obtain the following matrices:</p><div>\[\Gamma_0 = \begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0\\
-1 &amp; 1 &amp; 0 &amp; 0\\
0 &amp; -1 &amp; \sigma &amp; 1\\
0 &amp; 0 &amp; 0 &amp; \beta\\
\end{pmatrix},

\Gamma_1 = \begin{pmatrix}
 \rho_v &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; \phi_y &amp; \phi_pi\\
0 &amp; 0 &amp; \sigma &amp; 0\\
0 &amp; 0 &amp; -\kappa &amp; 1\\
\end{pmatrix},

\Psi = \begin{pmatrix}
1\\
0\\
0\\
0\\
\end{pmatrix},

\Pi = \begin{pmatrix}
0 &amp; 0\\
\phi_y &amp; \phi_pi\\
\sigma &amp; 0\\
-\kappa &amp; 1]]
\end{pmatrix}\]</div><p>See the end of this article for the whole maths of this pne. Here is it, in Julia:</p><div><pre><code class="language-julia">G0 = [[1 0 0 0];[-1 1 0 0];[0 -1 sigma 1];[0 0 0 beta]]
G1 = [[rho_v 0 0 0];[0 0 phi_y phi_pi];[0 0 sigma 0];[0 0 -kappa 1]]
Psi = [1 0 0 0]&#39;
Pi = [[0 phi_pi 0 1];[0 phi_y sigma -kappa]]&#39;

sol_sims = sims(G0,G1,Pi,Psi)

resul = irf(sol_sims.theta1,sol_sims.theta2,12,0.25)</code></pre><pre><code class="language-none">[ Info: Unique Solution Available
13×4 Array{Float64,2}:
 0.224117     0.0195473    -0.127705     -0.0322425
 0.112058     0.0477315    -0.0638527    -0.0161212
 0.0560292    0.0238657    -0.0319264    -0.00806062
 0.0280146    0.0119329    -0.0159632    -0.00403031
 0.0140073    0.00596644   -0.00798159   -0.00201515
 0.00700365   0.00298322   -0.00399079   -0.00100758
 0.00350182   0.00149161   -0.0019954    -0.000503788
 0.00175091   0.000745804  -0.000997699  -0.000251894
 0.000875456  0.000372902  -0.000498849  -0.000125947
 0.000437728  0.000186451  -0.000249425  -6.29736e-5
 0.000218864  9.32256e-5   -0.000124712  -3.14868e-5
 0.000109432  4.66128e-5   -6.23562e-5   -1.57434e-5
 5.4716e-5    2.33064e-5   -3.11781e-5   -7.87169e-6</code></pre></div><p>Last, but not least, Galí gives an analytical solution for <span>$\tilde{y}_t$</span> and <span>$\pi_t$</span> They are:</p><div>\[\tilde{y}_t = -(1-\beta{}\rho_v) \Lambda_v v_t\\
\pi_t = -\kappa\Lambda_v v_t\]</div><p>And <span>$\Lambda_v = \frac{1}{(1-\beta{}\rho_v)[\sigma(1-\rho_v)+\phi_y]+\kappa(\phi_{\pi}-\rho_v)}$</span></p><p>Lets put the analytical solutions in Julia:</p><div><pre><code class="language-julia">Lambda_v = 1/((1-beta*rho_v)*(sigma*(1-rho_v)+phi_y)+kappa*(phi_pi - rho_v))
true_y(v) = -(1-beta*rho_v)*Lambda_v*v
true_pi(v) = -kappa*Lambda_v*v

true_path = zeros(13,3)
initial_shock = 0.25
shock = zeros(13)
shock[2] = initial_shock

for j = 2:13
    true_path[j,1] = rho_v*true_path[j-1] + shock[j]
    true_path[j,2] = true_y(true_path[j,1])
    true_path[j,3] = true_pi(true_path[j,1])
end</code></pre></div><p>We are able to compare the analytical solution with the estimated solutions. First, the shock on <span>$v_t$</span></p><div><pre><code class="language-julia">plot(true_path[2:13,1], lab = &quot;Analytical Solution&quot;)
plot!(resul[:,1], lab = &quot;Gensys Answer&quot;)
plot!(klein_sol[:,1], lab = &quot;Klein Answer&quot;)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip0600">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<defs>
  <clipPath id="clip0601">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip0601)" points="
0,1600 2400,1600 2400,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip0602">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip0601)" points="
94.4882,1537.01 2321.26,1537.01 2321.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip0603">
    <rect x="94" y="47" width="2228" height="1491"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip0603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  420.101,1537.01 420.101,47.2441 
  "/>
<polyline clip-path="url(#clip0603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  857.753,1537.01 857.753,47.2441 
  "/>
<polyline clip-path="url(#clip0603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1295.4,1537.01 1295.4,47.2441 
  "/>
<polyline clip-path="url(#clip0603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1733.06,1537.01 1733.06,47.2441 
  "/>
<polyline clip-path="url(#clip0603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2170.71,1537.01 2170.71,47.2441 
  "/>
<polyline clip-path="url(#clip0603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1495.15 2321.26,1495.15 
  "/>
<polyline clip-path="url(#clip0603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1214 2321.26,1214 
  "/>
<polyline clip-path="url(#clip0603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,932.854 2321.26,932.854 
  "/>
<polyline clip-path="url(#clip0603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,651.705 2321.26,651.705 
  "/>
<polyline clip-path="url(#clip0603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,370.556 2321.26,370.556 
  "/>
<polyline clip-path="url(#clip0603)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,89.4072 2321.26,89.4072 
  "/>
<polyline clip-path="url(#clip0601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1537.01 2321.26,1537.01 
  "/>
<polyline clip-path="url(#clip0601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1537.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip0601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  420.101,1537.01 420.101,1514.66 
  "/>
<polyline clip-path="url(#clip0601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  857.753,1537.01 857.753,1514.66 
  "/>
<polyline clip-path="url(#clip0601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1295.4,1537.01 1295.4,1514.66 
  "/>
<polyline clip-path="url(#clip0601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1733.06,1537.01 1733.06,1514.66 
  "/>
<polyline clip-path="url(#clip0601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2170.71,1537.01 2170.71,1514.66 
  "/>
<polyline clip-path="url(#clip0601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1495.15 127.89,1495.15 
  "/>
<polyline clip-path="url(#clip0601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1214 127.89,1214 
  "/>
<polyline clip-path="url(#clip0601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,932.854 127.89,932.854 
  "/>
<polyline clip-path="url(#clip0601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,651.705 127.89,651.705 
  "/>
<polyline clip-path="url(#clip0601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,370.556 127.89,370.556 
  "/>
<polyline clip-path="url(#clip0601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,89.4072 127.89,89.4072 
  "/>
<g clip-path="url(#clip0601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 420.101, 1591.01)" x="420.101" y="1591.01">2.5</text>
</g>
<g clip-path="url(#clip0601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 857.753, 1591.01)" x="857.753" y="1591.01">5.0</text>
</g>
<g clip-path="url(#clip0601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1295.4, 1591.01)" x="1295.4" y="1591.01">7.5</text>
</g>
<g clip-path="url(#clip0601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1733.06, 1591.01)" x="1733.06" y="1591.01">10.0</text>
</g>
<g clip-path="url(#clip0601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2170.71, 1591.01)" x="2170.71" y="1591.01">12.5</text>
</g>
<g clip-path="url(#clip0601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 1512.65)" x="70.4882" y="1512.65">0.00</text>
</g>
<g clip-path="url(#clip0601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 1231.5)" x="70.4882" y="1231.5">0.05</text>
</g>
<g clip-path="url(#clip0601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 950.354)" x="70.4882" y="950.354">0.10</text>
</g>
<g clip-path="url(#clip0601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 669.205)" x="70.4882" y="669.205">0.15</text>
</g>
<g clip-path="url(#clip0601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 388.056)" x="70.4882" y="388.056">0.20</text>
</g>
<g clip-path="url(#clip0601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 106.907)" x="70.4882" y="106.907">0.25</text>
</g>
<polyline clip-path="url(#clip0603)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.51,89.4072 332.571,792.28 507.631,1143.72 682.692,1319.43 857.753,1407.29 1032.81,1451.22 1207.87,1473.19 1382.93,1484.17 1558,1489.66 1733.06,1492.41 
  1908.12,1493.78 2083.18,1494.47 
  "/>
<polyline clip-path="url(#clip0603)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.51,234.948 332.571,865.05 507.631,1180.1 682.692,1337.63 857.753,1416.39 1032.81,1455.77 1207.87,1475.46 1382.93,1485.31 1558,1490.23 1733.06,1492.69 
  1908.12,1493.92 2083.18,1494.54 2258.24,1494.84 
  "/>
<polyline clip-path="url(#clip0603)" style="stroke:#3da44d; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.51,89.4072 332.571,792.28 507.631,1143.72 682.692,1319.43 857.753,1407.29 1032.81,1451.22 1207.87,1473.19 1382.93,1484.17 1558,1489.66 1733.06,1492.41 
  1908.12,1493.78 2083.18,1494.47 
  "/>
<polygon clip-path="url(#clip0601)" points="
1616.01,372.684 2249.26,372.684 2249.26,130.764 1616.01,130.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip0601)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1616.01,372.684 2249.26,372.684 2249.26,130.764 1616.01,130.764 1616.01,372.684 
  "/>
<polyline clip-path="url(#clip0601)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1640.01,191.244 1784.01,191.244 
  "/>
<g clip-path="url(#clip0601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1808.01, 208.744)" x="1808.01" y="208.744">Analytical Solution</text>
</g>
<polyline clip-path="url(#clip0601)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1640.01,251.724 1784.01,251.724 
  "/>
<g clip-path="url(#clip0601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1808.01, 269.224)" x="1808.01" y="269.224">Gensys Answer</text>
</g>
<polyline clip-path="url(#clip0601)" style="stroke:#3da44d; stroke-width:4; stroke-opacity:1; fill:none" points="
  1640.01,312.204 1784.01,312.204 
  "/>
<g clip-path="url(#clip0601)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1808.01, 329.704)" x="1808.01" y="329.704">Klein Answer</text>
</g>
</svg>
</div><p>Here is the shock in the output gap:</p><div><pre><code class="language-julia">plot(true_path[2:13,2], lab = &quot;Analytical Solution&quot;)
plot!(resul[:,3], lab = &quot;Gensys Answer&quot;)
plot!(klein_sol[:,4], lab = &quot;Klein Answer&quot;)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip0700">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<defs>
  <clipPath id="clip0701">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip0701)" points="
0,1600 2400,1600 2400,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip0702">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip0701)" points="
94.4882,1537.01 2321.26,1537.01 2321.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip0703">
    <rect x="94" y="47" width="2228" height="1491"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip0703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  420.101,1537.01 420.101,47.2441 
  "/>
<polyline clip-path="url(#clip0703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  857.753,1537.01 857.753,47.2441 
  "/>
<polyline clip-path="url(#clip0703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1295.4,1537.01 1295.4,47.2441 
  "/>
<polyline clip-path="url(#clip0703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1733.06,1537.01 1733.06,47.2441 
  "/>
<polyline clip-path="url(#clip0703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2170.71,1537.01 2170.71,47.2441 
  "/>
<polyline clip-path="url(#clip0703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1322.63 2321.26,1322.63 
  "/>
<polyline clip-path="url(#clip0703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1075.95 2321.26,1075.95 
  "/>
<polyline clip-path="url(#clip0703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,829.276 2321.26,829.276 
  "/>
<polyline clip-path="url(#clip0703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,582.602 2321.26,582.602 
  "/>
<polyline clip-path="url(#clip0703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,335.928 2321.26,335.928 
  "/>
<polyline clip-path="url(#clip0703)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,89.2534 2321.26,89.2534 
  "/>
<polyline clip-path="url(#clip0701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1537.01 2321.26,1537.01 
  "/>
<polyline clip-path="url(#clip0701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1537.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip0701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  420.101,1537.01 420.101,1514.66 
  "/>
<polyline clip-path="url(#clip0701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  857.753,1537.01 857.753,1514.66 
  "/>
<polyline clip-path="url(#clip0701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1295.4,1537.01 1295.4,1514.66 
  "/>
<polyline clip-path="url(#clip0701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1733.06,1537.01 1733.06,1514.66 
  "/>
<polyline clip-path="url(#clip0701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2170.71,1537.01 2170.71,1514.66 
  "/>
<polyline clip-path="url(#clip0701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1322.63 127.89,1322.63 
  "/>
<polyline clip-path="url(#clip0701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1075.95 127.89,1075.95 
  "/>
<polyline clip-path="url(#clip0701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,829.276 127.89,829.276 
  "/>
<polyline clip-path="url(#clip0701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,582.602 127.89,582.602 
  "/>
<polyline clip-path="url(#clip0701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,335.928 127.89,335.928 
  "/>
<polyline clip-path="url(#clip0701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,89.2534 127.89,89.2534 
  "/>
<g clip-path="url(#clip0701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 420.101, 1591.01)" x="420.101" y="1591.01">2.5</text>
</g>
<g clip-path="url(#clip0701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 857.753, 1591.01)" x="857.753" y="1591.01">5.0</text>
</g>
<g clip-path="url(#clip0701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1295.4, 1591.01)" x="1295.4" y="1591.01">7.5</text>
</g>
<g clip-path="url(#clip0701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1733.06, 1591.01)" x="1733.06" y="1591.01">10.0</text>
</g>
<g clip-path="url(#clip0701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2170.71, 1591.01)" x="2170.71" y="1591.01">12.5</text>
</g>
<g clip-path="url(#clip0701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 1340.13)" x="70.4882" y="1340.13">-0.25</text>
</g>
<g clip-path="url(#clip0701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 1093.45)" x="70.4882" y="1093.45">-0.20</text>
</g>
<g clip-path="url(#clip0701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 846.776)" x="70.4882" y="846.776">-0.15</text>
</g>
<g clip-path="url(#clip0701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 600.102)" x="70.4882" y="600.102">-0.10</text>
</g>
<g clip-path="url(#clip0701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 353.428)" x="70.4882" y="353.428">-0.05</text>
</g>
<g clip-path="url(#clip0701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 106.753)" x="70.4882" y="106.753">0.00</text>
</g>
<polyline clip-path="url(#clip0703)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.51,1494.84 332.571,792.049 507.631,440.651 682.692,264.952 857.753,177.103 1032.81,133.178 1207.87,111.216 1382.93,100.235 1558,94.744 1733.06,91.9987 
  1908.12,90.6261 2083.18,89.9397 
  "/>
<polyline clip-path="url(#clip0703)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.51,719.286 332.571,404.27 507.631,246.762 682.692,168.008 857.753,128.63 1032.81,108.942 1207.87,99.0977 1382.93,94.1755 1558,91.7145 1733.06,90.4839 
  1908.12,89.8687 2083.18,89.561 2258.24,89.4072 
  "/>
<polyline clip-path="url(#clip0703)" style="stroke:#3da44d; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.51,792.049 332.571,440.651 507.631,264.952 682.692,177.103 857.753,133.178 1032.81,111.216 1207.87,100.235 1382.93,94.744 1558,91.9987 1733.06,90.6261 
  1908.12,89.9397 2083.18,89.5966 
  "/>
<polygon clip-path="url(#clip0701)" points="
1616.01,372.684 2249.26,372.684 2249.26,130.764 1616.01,130.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip0701)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1616.01,372.684 2249.26,372.684 2249.26,130.764 1616.01,130.764 1616.01,372.684 
  "/>
<polyline clip-path="url(#clip0701)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1640.01,191.244 1784.01,191.244 
  "/>
<g clip-path="url(#clip0701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1808.01, 208.744)" x="1808.01" y="208.744">Analytical Solution</text>
</g>
<polyline clip-path="url(#clip0701)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1640.01,251.724 1784.01,251.724 
  "/>
<g clip-path="url(#clip0701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1808.01, 269.224)" x="1808.01" y="269.224">Gensys Answer</text>
</g>
<polyline clip-path="url(#clip0701)" style="stroke:#3da44d; stroke-width:4; stroke-opacity:1; fill:none" points="
  1640.01,312.204 1784.01,312.204 
  "/>
<g clip-path="url(#clip0701)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1808.01, 329.704)" x="1808.01" y="329.704">Klein Answer</text>
</g>
</svg>
</div><p>And the shock in the inflation:</p><div><pre><code class="language-julia">plot(4*true_path[2:13,3], lab = &quot;Analytical Solution&quot;)
plot!(4*resul[:,4], lab = &quot;Gensys Answer&quot;)
plot!(4*klein_sol[:,3], lab = &quot;Klein Answer&quot;)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip0800">
    <rect x="0" y="0" width="2000" height="2000"/>
  </clipPath>
</defs>
<defs>
  <clipPath id="clip0801">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip0801)" points="
0,1600 2400,1600 2400,0 0,0 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip0802">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<polygon clip-path="url(#clip0801)" points="
94.4882,1537.01 2321.26,1537.01 2321.26,47.2441 94.4882,47.2441 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip0803">
    <rect x="94" y="47" width="2228" height="1491"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip0803)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  420.101,1537.01 420.101,47.2441 
  "/>
<polyline clip-path="url(#clip0803)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  857.753,1537.01 857.753,47.2441 
  "/>
<polyline clip-path="url(#clip0803)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1295.4,1537.01 1295.4,47.2441 
  "/>
<polyline clip-path="url(#clip0803)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1733.06,1537.01 1733.06,47.2441 
  "/>
<polyline clip-path="url(#clip0803)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2170.71,1537.01 2170.71,47.2441 
  "/>
<polyline clip-path="url(#clip0803)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1310.53 2321.26,1310.53 
  "/>
<polyline clip-path="url(#clip0803)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,1066.28 2321.26,1066.28 
  "/>
<polyline clip-path="url(#clip0803)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,822.021 2321.26,822.021 
  "/>
<polyline clip-path="url(#clip0803)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,577.765 2321.26,577.765 
  "/>
<polyline clip-path="url(#clip0803)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,333.509 2321.26,333.509 
  "/>
<polyline clip-path="url(#clip0803)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  94.4882,89.2534 2321.26,89.2534 
  "/>
<polyline clip-path="url(#clip0801)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1537.01 2321.26,1537.01 
  "/>
<polyline clip-path="url(#clip0801)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1537.01 94.4882,47.2441 
  "/>
<polyline clip-path="url(#clip0801)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  420.101,1537.01 420.101,1514.66 
  "/>
<polyline clip-path="url(#clip0801)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  857.753,1537.01 857.753,1514.66 
  "/>
<polyline clip-path="url(#clip0801)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1295.4,1537.01 1295.4,1514.66 
  "/>
<polyline clip-path="url(#clip0801)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1733.06,1537.01 1733.06,1514.66 
  "/>
<polyline clip-path="url(#clip0801)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2170.71,1537.01 2170.71,1514.66 
  "/>
<polyline clip-path="url(#clip0801)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1310.53 127.89,1310.53 
  "/>
<polyline clip-path="url(#clip0801)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,1066.28 127.89,1066.28 
  "/>
<polyline clip-path="url(#clip0801)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,822.021 127.89,822.021 
  "/>
<polyline clip-path="url(#clip0801)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,577.765 127.89,577.765 
  "/>
<polyline clip-path="url(#clip0801)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,333.509 127.89,333.509 
  "/>
<polyline clip-path="url(#clip0801)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  94.4882,89.2534 127.89,89.2534 
  "/>
<g clip-path="url(#clip0801)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 420.101, 1591.01)" x="420.101" y="1591.01">2.5</text>
</g>
<g clip-path="url(#clip0801)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 857.753, 1591.01)" x="857.753" y="1591.01">5.0</text>
</g>
<g clip-path="url(#clip0801)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1295.4, 1591.01)" x="1295.4" y="1591.01">7.5</text>
</g>
<g clip-path="url(#clip0801)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1733.06, 1591.01)" x="1733.06" y="1591.01">10.0</text>
</g>
<g clip-path="url(#clip0801)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2170.71, 1591.01)" x="2170.71" y="1591.01">12.5</text>
</g>
<g clip-path="url(#clip0801)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 1328.03)" x="70.4882" y="1328.03">-0.25</text>
</g>
<g clip-path="url(#clip0801)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 1083.78)" x="70.4882" y="1083.78">-0.20</text>
</g>
<g clip-path="url(#clip0801)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 839.521)" x="70.4882" y="839.521">-0.15</text>
</g>
<g clip-path="url(#clip0801)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 595.265)" x="70.4882" y="595.265">-0.10</text>
</g>
<g clip-path="url(#clip0801)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 351.009)" x="70.4882" y="351.009">-0.05</text>
</g>
<g clip-path="url(#clip0801)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 70.4882, 106.753)" x="70.4882" y="106.753">0.00</text>
</g>
<polyline clip-path="url(#clip0803)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.51,1494.84 332.571,792.049 507.631,440.651 682.692,264.952 857.753,177.103 1032.81,133.178 1207.87,111.216 1382.93,100.235 1558,94.744 1733.06,91.9987 
  1908.12,90.6261 2083.18,89.9397 
  "/>
<polyline clip-path="url(#clip0803)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.51,719.286 332.571,404.27 507.631,246.762 682.692,168.008 857.753,128.63 1032.81,108.942 1207.87,99.0977 1382.93,94.1755 1558,91.7145 1733.06,90.4839 
  1908.12,89.8687 2083.18,89.561 2258.24,89.4072 
  "/>
<polyline clip-path="url(#clip0803)" style="stroke:#3da44d; stroke-width:4; stroke-opacity:1; fill:none" points="
  157.51,792.049 332.571,440.651 507.631,264.952 682.692,177.103 857.753,133.178 1032.81,111.216 1207.87,100.235 1382.93,94.744 1558,91.9987 1733.06,90.6261 
  1908.12,89.9397 2083.18,89.5966 
  "/>
<polygon clip-path="url(#clip0801)" points="
1616.01,372.684 2249.26,372.684 2249.26,130.764 1616.01,130.764 
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip0801)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1616.01,372.684 2249.26,372.684 2249.26,130.764 1616.01,130.764 1616.01,372.684 
  "/>
<polyline clip-path="url(#clip0801)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1640.01,191.244 1784.01,191.244 
  "/>
<g clip-path="url(#clip0801)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1808.01, 208.744)" x="1808.01" y="208.744">Analytical Solution</text>
</g>
<polyline clip-path="url(#clip0801)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1640.01,251.724 1784.01,251.724 
  "/>
<g clip-path="url(#clip0801)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1808.01, 269.224)" x="1808.01" y="269.224">Gensys Answer</text>
</g>
<polyline clip-path="url(#clip0801)" style="stroke:#3da44d; stroke-width:4; stroke-opacity:1; fill:none" points="
  1640.01,312.204 1784.01,312.204 
  "/>
<g clip-path="url(#clip0801)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 1808.01, 329.704)" x="1808.01" y="329.704">Klein Answer</text>
</g>
</svg>
</div><p>The solutions of Klein`s method and gensys are actually close, but far away from the analytical solution. This seems to be due the Schur decomposition. Here is the IRF of the inflation to the same shock, but computed using Christopher Sims implementation in R:</p><p><img src="../Rplot01.png" alt/></p><footer><hr/><a class="previous" href="../klein/"><span class="direction">Previous</span><span class="title">Klein</span></a></footer></article></body></html>
